module.exports = function transformUpdate( args ) {

    if ( !args[ 2 ] ) args[ 2 ] = {};
    if ( !args[ 2 ].multi ) {
        if ( !args[ 1 ].$set ) args[ 1 ].$set = {};
        if ( !args[ 1 ].$set.updatedAt )
            args[ 1 ].$set.updatedAt = new Date();

        let sort = {};
        if ( args[ 2 ].sort ) {
            sort = args[ 2 ].sort;
            delete args[ 2 ].sort;
        }
        args[ 2 ].new = true;
        args = [
            args[ 0 ],
            sort,
            args[ 1 ],
            args[ 2 ]
        ];
    } else {
        if ( !args[ 1 ].$set )
            args[ 1 ].$set = {};
        if ( !args[ 1 ].$set.updatedAt )
            args[ 1 ].$set.updatedAt = new Date();
        args = [
            args[ 0 ],
            args[ 1 ],
            args[ 2 ]
        ];
    }

    return args;

};
