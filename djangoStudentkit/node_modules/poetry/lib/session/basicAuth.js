const Login = require( '../methods/login' ),
    Log = require( '../methods/log' );

module.exports = function basicAuth( request, reply ) {
    let token = request.headers.authorization.split( ' ', 2 )[ 1 ];
    token = Buffer.from(token, 'base64');
    token = token.toString().split(':', 2);

    const user = token[ 0 ];
    const pass = token[ 1 ];

    Log.silly( `[${request.headers['X-RequestUID']}] ðŸ”‘  BasicAuth ${user}`);

    const checkMobileToken = request.headers[ "User-Agent" ] && ~request.headers[ "User-Agent" ].indexOf( "Mobi" );

    return Login( user, pass, checkMobileToken );
};
